<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Deafbakery - æ•¸ä½æˆ°æƒ…å®¤</title>
    
    <!-- 1. è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. è¼‰å…¥ React æ ¸å¿ƒ -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 3. è¼‰å…¥ Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. è¨­å®š Tailwind æ“´å……æ¨£å¼ (é«˜ç´šæ’ç•«é¢¨) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        artisan: {
                            bg: '#F9F7F2',        // ç´™å¼µç±³ç™½
                            ink: '#2C2321',       // å¢¨è‰²æ·±æ£• (æ–‡å­—/é‚Šæ¡†)
                            gold: '#C69C6D',      // çƒ˜ç„™é‡‘
                            cream: '#FFFDF5',     // å¥¶æ²¹ç™½ (å¡ç‰‡èƒŒæ™¯)
                            accent: '#E65100',    // æ´»åŠ›æ©˜ (å¼·èª¿)
                            gray: '#8D8987',      // è³ªæ„Ÿç°
                            
                            // éƒ¨é–€è‰²ç³» (ä½é£½å’Œè«è˜­è¿ªè‰²)
                            red: '#F2D7D5',
                            blue: '#D6EAF8',
                            green: '#D5F5E3',
                            purple: '#EBDEF0',
                            yellow: '#FCF3CF',
                        }
                    },
                    boxShadow: {
                        'ink': '4px 4px 0px 0px #2C2321', // å¯¦å¿ƒæ‰‹ç¹ªé™°å½±
                        'ink-sm': '2px 2px 0px 0px #2C2321',
                        'ink-hover': '6px 6px 0px 0px #2C2321',
                    },
                    fontFamily: {
                        serif: ['"Noto Serif TC"', 'serif'],
                        sans: ['"Noto Sans TC"', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Serif+TC:wght@600;900&display=swap');

        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: #F9F7F2;
            color: #2C2321;
            /* ç´™å¼µç´‹ç†æ•ˆæœ */
            background-image: radial-gradient(#C69C6D 0.5px, transparent 0.5px), radial-gradient(#C69C6D 0.5px, #F9F7F2 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            background-blend-mode: multiply;
            opacity: 0.98;
        }

        /* è‡ªå®šç¾©æ²è»¸ */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #C69C6D; border-radius: 4px; border: 2px solid #F9F7F2; }
        ::-webkit-scrollbar-thumb:hover { background: #2C2321; }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- 1. Icons (ç²¾ç·»ç·šæ¢é¢¨æ ¼) ---
        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {path}
            </svg>
        );

        const Icons = {
            Search: (props) => <Icon {...props} path={<><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></>} />,
            ZoomIn: (props) => <Icon {...props} path={<><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/><line x1="11" x2="11" y1="8" y2="14"/><line x1="8" x2="14" y1="11" y2="11"/></>} />,
            ZoomOut: (props) => <Icon {...props} path={<><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/><line x1="8" x2="14" y1="11" y2="11"/></>} />,
            Edit: (props) => <Icon {...props} path={<><path d="M12 20h9"/><path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z"/></>} />,
            Save: (props) => <Icon {...props} path={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></>} />,
            X: (props) => <Icon {...props} path={<><path d="M18 6 6 18"/><path d="m6 6 12 12"/></>} />,
            User: (props) => <Icon {...props} path={<><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>} />,
            Users: (props) => <Icon {...props} path={<><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>} />,
            Building: (props) => <Icon {...props} path={<><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M12 6h.01"/><path d="M12 10h.01"/><path d="M12 14h.01"/><path d="M16 10h.01"/><path d="M16 14h.01"/><path d="M8 10h.01"/><path d="M8 14h.01"/></>} />,
            Layers: (props) => <Icon {...props} path={<><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></>} />,
            List: (props) => <Icon {...props} path={<><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></>} />,
            Layout: (props) => <Icon {...props} path={<><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="9" y2="21"/></>} />,
            Lock: (props) => <Icon {...props} path={<><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></>} />,
            KeyRound: (props) => <Icon {...props} path={<><path d="M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z"/><circle cx="16.5" cy="7.5" r=".5"/></>} />,
            Chef: (props) => <Icon {...props} path={<><path d="M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 9.08 0A5.11 5.11 0 0 1 18.59 6 4 4 0 0 1 20 13.87V21H6Z"/><line x1="6" y1="17" x2="20" y2="17"/></>} />
        };

        // --- 2. æ ¸å¿ƒè³‡æ–™ (2024/12/23 æœ€æ–°ç‰ˆ) ---
        // å·²ç¶“è½‰ç‚ºæ¨™æº– CSV æ ¼å¼ï¼Œé¿å… Tab è·‘ç‰ˆå•é¡Œ
        const INITIAL_CSV = `ID,Name,TechTitle,MgmtTitle,ParentID
CEO,æ½˜ä¿¡å®,,åŸ·è¡Œé•·,
COO,æ½˜é‡æ©,,ç‡Ÿé‹é•·,CEO
C_PROD,ç”Ÿç”¢ä¸­å¿ƒ,,ä¸­å¿ƒ,COO
C_LOGI,ç‰©æµä¸­å¿ƒ,,ä¸­å¿ƒ,COO
C_OPS,ç‡Ÿé‹ä¸­å¿ƒ,,ä¸­å¿ƒ,COO
C_MGM,ç®¡ç†ä¸­å¿ƒ,,ä¸­å¿ƒ,COO
D_PROD,ç”Ÿç”¢éƒ¨,,éƒ¨é–€,ç¾…æœˆæƒ 
D_PKG,åŒ…è£éƒ¨,,éƒ¨é–€,C_PROD
D_SHIP,å‡ºè²¨éƒ¨,,éƒ¨é–€,C_LOGI
D_LOGI,ç‰©æµéƒ¨,,éƒ¨é–€,C_LOGI
D_MKT,è¡ŒéŠ·éƒ¨,,éƒ¨é–€,C_OPS
D_SALES,éŠ·å”®éƒ¨,,éƒ¨é–€,C_OPS
D_CS,å®¢æœéƒ¨,,éƒ¨é–€,C_OPS
D_BD,å•†å‹™æ‹“å±•éƒ¨,,éƒ¨é–€,C_OPS
D_ADMIN,ç®¡ç†éƒ¨,,éƒ¨é–€,C_MGM
D_RD,ç ”ç™¼éƒ¨,,éƒ¨é–€,C_PROD
G_PM,å°ˆæ¡ˆç®¡ç†çµ„,,çµ„åˆ¥,é‚±å¤¢æ¶µ
G_ART,ç¾ç·¨çµ„,,çµ„åˆ¥,é‚±å¤¢æ¶µ
G_SNS,ç¤¾ç¾¤çµ„,,çµ„åˆ¥,é‚±å¤¢æ¶µ
G_PLAN,ä¼åŠƒçµ„,,çµ„åˆ¥,é‚±å¤¢æ¶µ
G_HR,äººåŠ›è³‡æºçµ„,,çµ„åˆ¥,D_ADMIN
G_GA,ç¸½å‹™è¡Œæ”¿çµ„,,çµ„åˆ¥,D_ADMIN
G_FIN,è²¡å‹™çµ„,,çµ„åˆ¥,D_ADMIN
G_IT,è³‡è¨Šç®¡ç†çµ„,,çµ„åˆ¥,D_ADMIN
G_FILL,é¤¡æ–™çµ„,,çµ„åˆ¥,D_PROD
G_CUT,åˆ‡å‰²çµ„,,çµ„åˆ¥,D_PROD
G_BAKE,çƒ˜çƒ¤çµ„,,çµ„åˆ¥,D_PROD
ç¾…æœˆæƒ ,ç¾…æœˆæƒ ,,ç¸½ç›£,C_PROD
å³å¤¢å©·,å³å¤¢å©·,,ç¶“ç†,D_BD
é™³å·§çŠ,é™³å·§çŠ,æ¥­å‹™å°ˆå“¡,,å³å¤¢å©·
é‚±å®—ä»,é‚±å®—ä»,ç‰©æµå°ˆå“¡,è¥„ç†,D_LOGI
è¬å‘ˆå¼¦,è¬å‘ˆå¼¦,ç‰©æµå°ˆå“¡,,é‚±å®—ä»
æå»ºèˆˆ,æå»ºèˆˆ,ç‰©æµå°ˆå“¡,,é‚±å®—ä»
è³´éŸ‹ä»²,è³´éŸ‹ä»²,ç†è²¨å°ˆå“¡,è¥„ç†,D_SHIP
èŠäºæ®,èŠäºæ®,ç†è²¨å°ˆå“¡,,è³´éŸ‹ä»²
ç¾…è™¹æ—»,ç¾…è™¹æ—»,ç†è²¨å°ˆå“¡,çµ„é•·,è³´éŸ‹ä»²
ç‹æƒ ç¦,ç‹æƒ ç¦,ç†è²¨å°ˆå“¡,çµ„é•·,è³´éŸ‹ä»²
è³´ç‘æ± ,è³´ç‘æ± ,ç†è²¨å°ˆå“¡,,è³´éŸ‹ä»²
å¼µç†’å€«,å¼µç†’å€«,ç†è²¨å“¡,,è³´éŸ‹ä»²
æ—æ·‘çª,æ—æ·‘çª,ç†è²¨å°ˆå“¡,,è³´éŸ‹ä»²
é™³çŸå©•,é™³çŸå©•,ç†è²¨å°ˆå“¡,,è³´éŸ‹ä»²
è—å¿ç¢§,è—å¿ç¢§,ç†è²¨å“¡,,è³´éŸ‹ä»²
é™³å·å€ª,é™³å·å€ª,ç†è²¨å“¡,,è³´éŸ‹ä»²
ç¾…å† ç³,ç¾…å† ç³,ç†è²¨å“¡,,è³´éŸ‹ä»²
è¬ç§€å¿,è¬ç§€å¿,ç†è²¨å“¡,,è³´éŸ‹ä»²
å¼µæ²›å«º,å¼µæ²›å«º,ç†è²¨å“¡,,è³´éŸ‹ä»²
é™³ç¾ä½™,é™³ç¾ä½™,ç†è²¨å“¡,,è³´éŸ‹ä»²
æ—ç¾æ™´,æ—ç¾æ™´,ç†è²¨å“¡,,è³´éŸ‹ä»²
å¾ç®åº­,å¾ç®åº­,éŠ·å”®å°ˆå“¡,å„²å‚™å¹¹éƒ¨,é¡§åº­ç‘‹
è¨±é›…æƒ ,è¨±é›…æƒ ,éŠ·å”®äººå“¡,,å¾ç®åº­
æ½˜åè²,æ½˜åè²,éŠ·å”®äººå“¡,,å¾ç®åº­
è•­ç¾½å©·,è•­ç¾½å©·,éŠ·å”®äººå“¡,,å¾ç®åº­
é»ƒæƒ ç²,é»ƒæƒ ç²,åŒ…è£å°ˆå“¡,è¥„ç†,D_PKG
è­šæ–‡ç¦,è­šæ–‡ç¦,åŒ…è£å°ˆå“¡,çµ„é•·,é»ƒæƒ ç²
ç›§æ€¡å®‰,ç›§æ€¡å®‰,åŒ…è£å°ˆå“¡,çµ„é•·,é»ƒæƒ ç²
ç‹è‹¥è“,ç‹è‹¥è“,åŒ…è£å°ˆå“¡,çµ„é•·,é»ƒæƒ ç²
è³´ç¾½çŠ,è³´ç¾½çŠ,åŒ…è£å°ˆå“¡,,é»ƒæƒ ç²
æç¾ç²,æç¾ç²,åŒ…è£å“¡,,é»ƒæƒ ç²
è”¡é›…å§,è”¡é›…å§,åŒ…è£å“¡,,é»ƒæƒ ç²
æ¸¸é›…é›¯,æ¸¸é›…é›¯,åŒ…è£å“¡,,é»ƒæƒ ç²
ä½•å¦‚é›,ä½•å¦‚é›,åŒ…è£å“¡,,é»ƒæƒ ç²
è³´å®œè²,è³´å®œè²,åŒ…è£å“¡,,é»ƒæƒ ç²
ææ¶”ç‘œ,ææ¶”ç‘œ,åŒ…è£å“¡,,é»ƒæƒ ç²
æ²ˆå‚³ä»,æ²ˆå‚³ä»,åŒ…è£å“¡,,é»ƒæƒ ç²
æ—å¦ç¶¸,æ—å¦ç¶¸,åŒ…è£å“¡,,é»ƒæƒ ç²
åŠ‰æ˜Ÿå²‘,åŠ‰æ˜Ÿå²‘,åŒ…è£å“¡,,é»ƒæƒ ç²
åˆ©å‰éŠ¨,åˆ©å‰éŠ¨,è³‡æ·±ç ”ç™¼å°ˆå“¡,ç ”ç™¼ä¸»å»š,D_RD
å“ä½³è“‰,å“ä½³è“‰,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
ææ€¡çŠ,ææ€¡çŠ,è³‡æ·±æŠ€è¡“å°ˆå“¡,,åˆ©å‰éŠ¨
è”¡å­Ÿåº­,è”¡å­Ÿåº­,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
æ›¹æŸå‡±,æ›¹æŸå‡±,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
æ´ªå­èª¼,æ´ªå­èª¼,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
åŠ‰ç¾¿å›,åŠ‰ç¾¿å›,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
é™³æµšå®,é™³æµšå®,æŠ€è¡“å°ˆå“¡,å» å‹™,ç¾…æœˆæƒ 
é„­éœå®œ,é„­éœå®œ,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
é¾é¨„éœ‡,é¾é¨„éœ‡,æŠ€è¡“å°ˆå“¡,çµ„é•·,ç¾…æœˆæƒ 
æ±ªå»ºä½‘,æ±ªå»ºä½‘,æŠ€è¡“å°ˆå“¡,,å“ä½³è“‰
æŸ¯æ³³å®‰,æŸ¯æ³³å®‰,æŠ€è¡“å°ˆå“¡,,å“ä½³è“‰
è‘‰æ–‡ç³,è‘‰æ–‡ç³,ä½œæ¥­å“¡,,å“ä½³è“‰
é»ƒä½³ç¥º,é»ƒä½³ç¥º,ä½œæ¥­å“¡,é£Ÿå®‰ç®¡ç†äººå“¡,å“ä½³è“‰
åŠ‰æ±´è±,åŠ‰æ±´è±,ä½œæ¥­å“¡,,å“ä½³è“‰
å³æŸ”æ¼ª,å³æŸ”æ¼ª,ä½œæ¥­å“¡,,å“ä½³è“‰
é™³éŸ»åµ,é™³éŸ»åµ,ä½œæ¥­å“¡,,å“ä½³è“‰
ææ˜•åº­,ææ˜•åº­,ä½œæ¥­å“¡,,å“ä½³è“‰
è‘£ä¿Šä½‘,è‘£ä¿Šä½‘,ä½œæ¥­å“¡,,å“ä½³è“‰
æ±ªå»ºé”,æ±ªå»ºé”,ä½œæ¥­å“¡,,å“ä½³è“‰
è”¡è© ç¿”,è”¡è© ç¿”,ä½œæ¥­å“¡,,å“ä½³è“‰
è‘‰æŸå¿—,è‘‰æŸå¿—,ä½œæ¥­å“¡,,å“ä½³è“‰
é»ƒå¨æ™º,é»ƒå¨æ™º,ä½œæ¥­å“¡,,å“ä½³è“‰
æ—è¯è±,æ—è¯è±,ä½œæ¥­å“¡,,å“ä½³è“‰
è•­é–å¬™,è•­é–å¬™,ç¾ç·¨å°ˆå“¡,çµ„é•·,G_ART
é‚±å¤¢æ¶µ,é‚±å¤¢æ¶µ,è³‡æ·±å°ˆæ¡ˆåŸ·è¡Œ,ç¶“ç†,D_MKT
è˜‡ç¾¿ç‘„,è˜‡ç¾¿ç‘„,ç¤¾ç¾¤å°ˆå“¡,çµ„é•·,G_SNS
è˜‡å‡Œè±,è˜‡å‡Œè±,å°ˆæ¡ˆåŸ·è¡Œå°ˆå“¡,,G_PM
å¼µå®œå©·,å¼µå®œå©·,å°ˆæ¡ˆåŸ·è¡Œå°ˆå“¡,,G_PM
æ´ªåƒæƒŸ,æ´ªåƒæƒŸ,ç¾ç·¨å°ˆå“¡,,è•­é–å¬™
æ—å­£å«»,æ—å­£å«»,å°ˆæ¡ˆåŸ·è¡Œå°ˆå“¡,,G_PM
è¨±å¯æ¦†,è¨±å¯æ¦†,ç¤¾ç¾¤å°ç·¨,,è˜‡ç¾¿ç‘„
é™³æ¥·æ›œ,é™³æ¥·æ›œ,ç¤¾ç¾¤å°ç·¨,,è˜‡ç¾¿ç‘„
æ›¹æ«»æ¨º,æ›¹æ«»æ¨º,å°ˆæ¡ˆåŸ·è¡Œå°ˆå“¡,,G_PM
å¾è‹‘å¦®,å¾è‹‘å¦®,æœƒè¨ˆäººå“¡,,G_FIN
å»–è©©æ—»,å»–è©©æ—»,è³‡æ·±å°ˆå“¡,,G_HR
ä½•èŠ¸èŠ³,ä½•èŠ¸èŠ³,å°ˆå“¡,,G_HR
é™³ä¿Šå‰,é™³ä¿Šå‰,å°ˆå“¡,,G_GA
é„­é‹†æ…ˆ,é„­é‹†æ…ˆ,å°ˆå“¡,,G_HR
è”¡è‡»å¦®,è”¡è‡»å¦®,å°ˆå“¡,,G_GA
æ¥Šæ·¨é›¯,æ¥Šæ·¨é›¯,å°ˆå“¡,,G_GA
æ—å–¬æ˜•,æ—å–¬æ˜•,å°ˆå“¡,,G_GA
è³´ç‰ç ,è³´ç‰ç ,å°ˆå“¡,,G_GA
ç‹ä½‘çŠ,ç‹ä½‘çŠ,å®¢æœå°ˆå“¡,è¥„ç†,D_CS
æ½˜å‰é›…,æ½˜å‰é›…,å®¢æœå°ˆå“¡,,ç‹ä½‘çŠ
æ—å§¿ç©,æ—å§¿ç©,å®¢æœå°ˆå“¡,,ç‹ä½‘çŠ
é‚±æ…§å§,é‚±æ…§å§,å®¢æœå°ˆå“¡,,ç‹ä½‘çŠ
æ¸¸æ˜­çª,æ¸¸æ˜­çª,å®¢æœå°ˆå“¡,,ç‹ä½‘çŠ
é¡§åº­ç‘‹,é¡§åº­ç‘‹,,å…¼ä»»ç¶“ç†,D_SALES
æ½˜å…¨æ©,æ½˜å…¨æ©,,è³‡è¨Šé•·,G_IT`;

        // --- 3. é«˜ç´šæ’ç•«é¢¨æ ¼é‚è¼¯ ---

        const getLevelStyle = (level, mgmtTitle) => {
            const title = mgmtTitle || ''; 
            const baseClass = "relative overflow-hidden transition-all duration-300 border-2 border-artisan-ink shadow-ink bg-artisan-cream";
            
            // åŸ·è¡Œé•·/é«˜å±¤ - é‡‘è‰²ç³»
            if (title.includes('åŸ·è¡Œé•·') || title.includes('è‘£äº‹é•·') || title.includes('è³‡è¨Šé•·')) {
                return `${baseClass} bg-artisan-yellow/50 hover:bg-artisan-yellow hover:shadow-ink-hover hover:-translate-y-1`;
            }
            // ç‡Ÿé‹é•·/ç¸½ç›£ - æ©˜è‰²ç³»
            if (title.includes('ç‡Ÿé‹é•·') || title.includes('ç¸½ç¶“ç†') || title.includes('ç¸½ç›£')) {
                return `${baseClass} bg-artisan-red/50 hover:bg-artisan-red hover:shadow-ink-hover hover:-translate-y-1`;
            }
            // ä¸­å¿ƒ - è—è‰²ç³»
            if (title.includes('ä¸­å¿ƒ')) {
                return `${baseClass} bg-artisan-blue/50 hover:bg-artisan-blue hover:shadow-ink-hover hover:-translate-y-1`;
            }
            // éƒ¨é–€ - ç¶ è‰²ç³»
            if (title.includes('éƒ¨é–€') || title.includes('ç¶“ç†') || title.includes('è¥„ç†') || title.includes('ä¸»ä»»')) {
                return `${baseClass} bg-artisan-green/50 hover:bg-artisan-green hover:shadow-ink-hover hover:-translate-y-1`;
            }
            // çµ„åˆ¥ - ç´«è‰²ç³»
            if (title.includes('çµ„åˆ¥') || title.includes('çµ„é•·') || title.includes('å¹¹éƒ¨') || title.includes('é ˜ç­') || title.includes('ç·šé•·')) {
                return `${baseClass} bg-artisan-purple/50 hover:bg-artisan-purple hover:shadow-ink-hover hover:-translate-y-1`;
            }

            // ä¸€èˆ¬ - ç°¡ç´„ç™½
            return `${baseClass} hover:bg-white hover:shadow-ink-hover hover:-translate-y-1`; 
        };

        // --- List View Component ---
        const ListView = ({ node, level = 0, searchTerm }) => {
            const [expanded, setExpanded] = useState(true);
            const hasChildren = node.children && node.children.length > 0;
            
            const isMatch = searchTerm && (
                node.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                (node.mgmtTitle && node.mgmtTitle.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (node.techTitle && node.techTitle.toLowerCase().includes(searchTerm.toLowerCase()))
            );

            useEffect(() => {
                if (isMatch) setExpanded(true);
            }, [isMatch]);

            if (searchTerm && !isMatch && !expanded) return null;

            const indent = level * 20;
            const hasMgmtTitle = node.mgmtTitle && node.mgmtTitle.trim() !== '';

            // åˆ—è¡¨æ¨£å¼
            let rowClass = "border-l-4 border-artisan-ink/20 hover:bg-artisan-gold/10";
            let textClass = "text-artisan-ink font-medium";
            
            if (level === 0) { rowClass = "border-l-4 border-artisan-gold bg-artisan-gold/20"; textClass = "font-bold text-lg"; }
            else if (level === 1) { rowClass = "border-l-4 border-artisan-ink bg-artisan-ink/5"; textClass = "font-bold"; }
            
            return (
                <div className="w-full font-sans mb-1">
                    <div 
                        className={`flex items-center p-3 cursor-pointer transition-all rounded-r-lg ${rowClass} ${isMatch ? 'bg-artisan-yellow border-artisan-accent' : ''}`}
                        style={{ marginLeft: `${indent}px`, width: `calc(100% - ${indent}px)` }}
                        onClick={() => setExpanded(!expanded)}
                    >
                        <div className="mr-3 w-6 flex justify-center text-artisan-ink">
                            {hasChildren ? (expanded ? 'â–¼' : 'â–¶') : <div className="w-2 h-2 bg-artisan-gray rounded-full"></div>}
                        </div>
                        
                        <div className="flex-1 flex flex-wrap items-center gap-3">
                            <span className={`${textClass}`}>
                                {node.name}
                            </span>
                            {hasMgmtTitle && (
                                <span className="text-xs px-2 py-0.5 border-2 border-artisan-ink rounded-full bg-white font-bold tracking-wide shadow-sm">
                                    {node.mgmtTitle}
                                </span>
                            )}
                            {node.techTitle && (
                                <span className="text-sm text-artisan-gray italic">
                                    {node.techTitle}
                                </span>
                            )}
                        </div>
                    </div>
                    
                    {hasChildren && expanded && (
                        <div className="animate-[fadeIn_0.3s_ease-out]">
                            {node.children.map(child => (
                                <ListView key={child.id} node={child} level={level + 1} searchTerm={searchTerm} />
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // --- Chart View Components ---
        const CompactNodeGroup = ({ nodes, level, searchTerm }) => {
            return (
                <div className="flex flex-col items-center pt-6 relative">
                    {/* æ‰‹ç¹ªé€£æ¥ç·š */}
                    <div className="w-0.5 h-6 bg-artisan-ink -mt-6 mb-4"></div>
                    
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 bg-white/80 border-2 border-artisan-ink p-4 rounded-lg shadow-ink relative">
                        {/* è£é£¾é‡˜å­ */}
                        <div className="absolute top-2 left-2 w-2 h-2 rounded-full bg-artisan-ink/20"></div>
                        <div className="absolute top-2 right-2 w-2 h-2 rounded-full bg-artisan-ink/20"></div>
                        <div className="absolute bottom-2 left-2 w-2 h-2 rounded-full bg-artisan-ink/20"></div>
                        <div className="absolute bottom-2 right-2 w-2 h-2 rounded-full bg-artisan-ink/20"></div>

                        {nodes.map(node => {
                            const hasMgmtTitle = node.mgmtTitle && node.mgmtTitle.trim() !== '';
                            const isMatch = searchTerm && (
                                node.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                (node.mgmtTitle && node.mgmtTitle.toLowerCase().includes(searchTerm.toLowerCase())) ||
                                (node.techTitle && node.techTitle.toLowerCase().includes(searchTerm.toLowerCase()))
                            );

                            return (
                                <div 
                                    key={node.id}
                                    className={`
                                        flex flex-col p-3 bg-white rounded border-2 border-artisan-ink/20 w-40 hover:border-artisan-gold hover:shadow-md transition-all
                                        ${isMatch ? 'ring-2 ring-artisan-accent bg-artisan-yellow' : ''}
                                    `}
                                >
                                    <div className="flex items-center justify-between mb-1">
                                        <span className="font-bold text-artisan-ink text-sm truncate">{node.name}</span>
                                        {hasMgmtTitle && <span className="text-[10px] bg-artisan-ink text-white px-1.5 py-0.5 rounded-sm">{node.mgmtTitle}</span>}
                                    </div>
                                    {node.techTitle && <span className="text-[11px] text-artisan-gray truncate font-medium">{node.techTitle}</span>}
                                </div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        const OrgNode = ({ node, level, searchTerm }) => {
            const [expanded, setExpanded] = useState(true);
            const isMatch = searchTerm && (
                node.name.toLowerCase().includes(searchTerm.toLowerCase()) || 
                (node.mgmtTitle && node.mgmtTitle.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (node.techTitle && node.techTitle.toLowerCase().includes(searchTerm.toLowerCase()))
            );

            useEffect(() => {
                if (isMatch) setExpanded(true);
            }, [isMatch]);

            const hasChildren = node.children && node.children.length > 0;
            const hasMgmtTitle = node.mgmtTitle && node.mgmtTitle.trim() !== '';
            
            const isLeafGroup = hasChildren && level > 1 && node.children.length > 2 && node.children.every(child => !child.children || child.children.length === 0);

            const getIcon = () => {
                const iconClass = "w-5 h-5 mr-2 opacity-80";
                if (!hasMgmtTitle) return null;
                if (node.mgmtTitle.includes('é•·') || node.mgmtTitle.includes('ç›£')) return <Icons.User className={iconClass} />;
                if (node.mgmtTitle.includes('ä¸­å¿ƒ')) return <Icons.Building className={iconClass} />;
                if (node.mgmtTitle.includes('éƒ¨')) return <Icons.Layers className={iconClass} />;
                if (node.mgmtTitle.includes('çµ„')) return <Icons.Users className={iconClass} />;
                return <Icons.User className={iconClass} />;
            }

            return (
                <div className="flex flex-col items-center relative z-10">
                    <div 
                        className={`
                            px-6 py-4 m-4 w-60 min-h-[6rem] justify-center cursor-pointer rounded-lg
                            ${getLevelStyle(level, node.mgmtTitle)}
                            ${isMatch ? 'ring-4 ring-artisan-accent scale-105' : ''}
                            ${!expanded && hasChildren ? 'opacity-80 grayscale' : ''}
                        `}
                        onClick={() => setExpanded(!expanded)}
                    >
                        {hasMgmtTitle && (
                            <div className="flex items-center text-lg font-black tracking-wider mb-2 border-b-2 border-dashed border-artisan-ink/20 pb-2 w-full justify-center text-artisan-ink">
                                {getIcon()}
                                {node.mgmtTitle}
                            </div>
                        )}

                        <div className={`text-lg font-bold text-center leading-tight tracking-wide text-artisan-ink ${hasMgmtTitle ? '' : 'mt-1'} ${level===0 ? 'text-2xl font-serif' : ''}`}>
                            {node.name}
                        </div>

                        {node.techTitle && (
                            <div className={`text-sm mt-2 font-medium px-2 py-0.5 rounded text-center truncate text-artisan-gray
                                ${hasMgmtTitle ? 'bg-white/50' : ''}
                            `}>
                                {node.techTitle}
                            </div>
                        )}
                        
                        {hasChildren && (
                            <div className="absolute -bottom-4 left-1/2 -translate-x-1/2 bg-white rounded-full w-8 h-8 flex items-center justify-center text-sm border-2 border-artisan-ink text-artisan-ink hover:bg-artisan-gold hover:text-white transition-colors z-20 shadow-sm cursor-pointer font-bold">
                                {expanded ? 'âˆ’' : '+'}
                            </div>
                        )}
                    </div>

                    {hasChildren && expanded && (
                        <>
                            {isLeafGroup ? (
                                <CompactNodeGroup nodes={node.children} level={level + 1} searchTerm={searchTerm} />
                            ) : (
                                <div className="flex flex-col items-center animate-[fadeIn_0.5s_ease-out] relative mt-4">
                                    <div className="w-0.5 h-8 bg-artisan-ink -mt-4"></div>
                                    <div className="flex relative pt-6">
                                        {node.children.length > 1 && (
                                            <div className="absolute top-0 left-1/2 -translate-x-1/2 w-[calc(100%-16rem)] h-0.5 bg-artisan-ink mt-0"></div>
                                        )}
                                        {node.children.map((child, index) => (
                                            <div key={child.id} className="flex flex-col items-center px-4 relative">
                                                <div className="w-0.5 h-6 bg-artisan-ink absolute top-0 left-1/2 -translate-x-1/2 -mt-6"></div>
                                                <OrgNode node={child} level={level + 1} searchTerm={searchTerm} />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </>
                    )}
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            const [csvData, setCsvData] = useState(INITIAL_CSV);
            const [treeData, setTreeData] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [isEditing, setIsEditing] = useState(false);
            const [showAuthModal, setShowAuthModal] = useState(false);
            const [passwordInput, setPasswordInput] = useState('');
            const [authError, setAuthError] = useState(false);
            const [scale, setScale] = useState(1);
            const [viewMode, setViewMode] = useState('chart'); 
            const containerRef = useRef(null);
            const passwordInputRef = useRef(null);

            useEffect(() => {
                if (window.innerWidth < 768) {
                    setViewMode('list');
                }
            }, []);

            // Robust Parser with Auto-Alignment for Tab-Separated Values
            const parseCSV = (csvText) => {
                try {
                    const lines = csvText.trim().split('\n');
                    const items = [];
                    let headers = [];
                    let hasExplicitHeader = false;

                    lines.forEach((line, index) => {
                        if (!line.trim()) return;
                        
                        const delimiter = line.includes('\t') ? '\t' : ',';
                        // Keep empty strings for alignment by not filtering immediately
                        let parts = line.split(delimiter).map(p => p.trim());
                        
                        // Header detection logic
                        const isHeaderRow = parts.some(p => p.toLowerCase() === 'id') && 
                                          parts.some(p => p.includes('Name') || p.includes('å¤§å') || p.includes('å§“å'));
                        
                        if (items.length === 0 && isHeaderRow) {
                           headers = parts.map(h => h.toLowerCase().replace(/\s/g, ''));
                           hasExplicitHeader = true;
                           return;
                        }
                        
                        // Default header assumption for 5 columns (matches Excel structure)
                        if (items.length === 0 && !hasExplicitHeader && !isHeaderRow) {
                            headers = ['id', 'name', 'techtitle', 'mgmttitle', 'parentid'];
                        }

                        if (parts.length < 2) return;

                        const item = {};
                        
                        const idIdx = headers.findIndex(h => h === 'id');
                        const nameIdx = headers.findIndex(h => h.includes('name') || h.includes('å'));
                        const techIdx = headers.findIndex(h => h.includes('tech') || h.includes('æŠ€è¡“') || h === 'è·ç¨±');
                        const mgmtIdx = headers.findIndex(h => h.includes('mgmt') || h.includes('ç®¡ç†')); 
                        const parentIdx = headers.findIndex(h => h.includes('parent') || h.includes('ä¸»ç®¡') || h.includes('Parent'));

                        if (idIdx !== -1 && parts[idIdx]) item.id = parts[idIdx];
                        if (nameIdx !== -1 && parts[nameIdx]) item.name = parts[nameIdx];
                        
                        item.mgmtTitle = (mgmtIdx !== -1 && parts[mgmtIdx]) ? parts[mgmtIdx] : '';
                        item.techTitle = (techIdx !== -1 && parts[techIdx]) ? parts[techIdx] : '';
                        
                        // Smart ParentID Detection
                        // If header is detected, rely on index.
                        // If not, and we have 5 columns, assume last column is ParentID
                        if (parentIdx !== -1 && parts[parentIdx]) {
                            item.parentId = parts[parentIdx];
                        } else if (parts.length >= 5) {
                            // Only assign if it looks like an ID or Name, not empty
                            const lastVal = parts[parts.length-1];
                            if (lastVal) {
                                item.parentId = lastVal; 
                            }
                        }

                        // Auto-fill titles for organization nodes if missing
                        if (!item.mgmtTitle) {
                            if (item.id && item.id.startsWith('C_')) item.mgmtTitle = 'ä¸­å¿ƒ';
                            if (item.id && item.id.startsWith('D_')) item.mgmtTitle = 'éƒ¨é–€';
                            if (item.id && item.id.startsWith('G_')) item.mgmtTitle = 'çµ„åˆ¥';
                        }

                        if (item.id && item.name) items.push(item);
                    });

                    const idMapping = items.reduce((acc, el, i) => {
                        acc[el.id] = i;
                        return acc;
                    }, {});

                    let potentialRoots = [];
                    items.forEach(el => {
                        if (!el.parentId || el.parentId === '') {
                            potentialRoots.push(el);
                            return;
                        }
                        
                        // Prevent self-loop
                        if (el.parentId === el.id || el.parentId === el.name) {
                            potentialRoots.push(el);
                            return;
                        }

                        let parentEl = items[idMapping[el.parentId]];
                        
                        // Fallback: Find by name
                        if (!parentEl) {
                           const parentByName = items.find(i => i.name === el.parentId);
                           if (parentByName) parentEl = parentByName;
                        }

                        if (parentEl) {
                            parentEl.children = [...(parentEl.children || []), el];
                        } else {
                            potentialRoots.push(el);
                        }
                    });
                    
                    const root = potentialRoots.find(r => r.id === 'CEO') || potentialRoots[0];
                    return root;

                } catch (e) {
                    console.error("Parse Error", e);
                    return null;
                }
            };

            useEffect(() => {
                const root = parseCSV(csvData);
                setTreeData(root);
            }, [csvData]);

            const handleEditClick = () => {
                if (isEditing) {
                    setIsEditing(false);
                } else {
                    setShowAuthModal(true);
                    setTimeout(() => passwordInputRef.current?.focus(), 100);
                }
            };

            const verifyPassword = (e) => {
                e.preventDefault();
                if (passwordInput === '22332525') {
                    setShowAuthModal(false);
                    setIsEditing(true);
                    setPasswordInput('');
                    setAuthError(false);
                } else {
                    setAuthError(true);
                    const input = passwordInputRef.current;
                    if (input) {
                        input.classList.add('animate-[shake_0.5s_ease-in-out]');
                        setTimeout(() => input.classList.remove('animate-[shake_0.5s_ease-in-out]'), 500);
                    }
                }
            };

            const handleZoom = (delta) => {
                setScale(prev => Math.min(Math.max(prev + delta, 0.3), 2));
            };

            return (
                <div className="flex flex-col h-screen overflow-hidden relative font-sans text-artisan-ink">
                    
                    {/* Auth Modal */}
                    {showAuthModal && (
                        <div className="absolute inset-0 z-50 flex items-center justify-center bg-artisan-ink/50 backdrop-blur-sm animate-[fadeIn_0.3s_ease-out]">
                            <div className="bg-artisan-bg border-4 border-artisan-ink p-8 rounded-lg shadow-ink w-full max-w-sm relative">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-xl font-bold text-artisan-ink flex items-center gap-2 font-serif">
                                        <Icons.Lock className="w-6 h-6 text-artisan-accent" /> ç®¡ç†å“¡é©—è­‰
                                    </h3>
                                    <button onClick={() => {setShowAuthModal(false); setAuthError(false); setPasswordInput('');}} className="text-artisan-gray hover:text-artisan-ink"><Icons.X className="w-6 h-6" /></button>
                                </div>
                                <form onSubmit={verifyPassword} className="space-y-6">
                                    <div>
                                        <label className="block text-sm font-bold text-artisan-ink mb-2">è«‹è¼¸å…¥é€šè¡Œç¢¼</label>
                                        <div className="relative group">
                                            <div className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-artisan-gray"><Icons.KeyRound className="w-5 h-5"/></div>
                                            <input 
                                                ref={passwordInputRef}
                                                type="password" 
                                                value={passwordInput}
                                                onChange={(e) => setPasswordInput(e.target.value)}
                                                className={`w-full pl-10 pr-4 py-3 bg-white border-2 rounded outline-none transition-all font-bold tracking-widest text-lg ${authError ? 'border-red-500' : 'border-artisan-ink focus:border-artisan-accent'}`}
                                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                            />
                                        </div>
                                        {authError && <p className="text-red-500 text-xs mt-2 font-bold">>> å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡è©¦</p>}
                                    </div>
                                    <button type="submit" className="w-full bg-artisan-ink text-white py-3 rounded font-bold hover:bg-artisan-accent transition-all shadow-ink-sm hover:shadow-ink hover:-translate-y-0.5">ç¢ºèªé€²å…¥</button>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Toolbar */}
                    <div className="bg-artisan-bg/95 border-b-4 border-artisan-ink/10 p-4 flex flex-wrap items-center justify-between z-20 gap-4 relative shadow-sm">
                        <div className="flex items-center gap-4">
                            <div className="bg-artisan-gold p-2 rounded-lg border-2 border-artisan-ink text-white shadow-ink-sm animate-[float_4s_ease-in-out_infinite]">
                                <Icons.Chef className="w-8 h-8" />
                            </div>
                            <div>
                                <h1 className="text-2xl md:text-3xl font-black text-artisan-ink font-serif tracking-wide">Deafbakery</h1>
                                <p className="text-xs text-artisan-gray font-bold tracking-widest uppercase">Premium Artisan Team</p>
                            </div>
                        </div>

                        <div className="flex bg-white p-1 rounded-lg border-2 border-artisan-ink/20">
                           <button onClick={() => setViewMode('chart')} className={`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-bold transition-all ${viewMode === 'chart' ? 'bg-artisan-ink text-white shadow-md' : 'text-artisan-gray hover:text-artisan-ink'}`}><Icons.Layout className="w-5 h-5" /> <span className="hidden md:inline">åœ–è¡¨æ¨¡å¼</span></button>
                           <button onClick={() => setViewMode('list')} className={`flex items-center gap-2 px-4 py-2 rounded-md text-sm font-bold transition-all ${viewMode === 'list' ? 'bg-artisan-ink text-white shadow-md' : 'text-artisan-gray hover:text-artisan-ink'}`}><Icons.List className="w-5 h-5" /> <span className="hidden md:inline">åˆ—è¡¨æ¨¡å¼</span></button>
                        </div>

                        <div className="relative flex-1 max-w-xs group">
                            <div className="absolute left-3 top-1/2 -translate-y-1/2 text-artisan-gray group-focus-within:text-artisan-accent transition-colors"><Icons.Search className="w-5 h-5"/></div>
                            <input type="text" placeholder="æœå°‹å¤¥ä¼´..." className="w-full pl-10 pr-4 py-2 bg-white border-2 border-artisan-ink/20 rounded-lg focus:border-artisan-ink outline-none transition-all placeholder:text-artisan-gray/50 text-artisan-ink font-bold shadow-sm" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                        </div>

                        <div className="flex items-center gap-3">
                            {viewMode === 'chart' && (
                                <div className="flex bg-white rounded-lg border-2 border-artisan-ink/20 p-1 hidden md:flex">
                                    <button onClick={() => handleZoom(-0.1)} className="p-2 hover:text-artisan-accent text-artisan-gray transition-colors"><Icons.ZoomOut className="w-5 h-5" /></button>
                                    <span className="text-sm text-artisan-ink w-12 flex items-center justify-center font-bold border-x-2 border-artisan-ink/10">{Math.round(scale * 100)}%</span>
                                    <button onClick={() => handleZoom(0.1)} className="p-2 hover:text-artisan-accent text-artisan-gray transition-colors"><Icons.ZoomIn className="w-5 h-5" /></button>
                                </div>
                            )}
                            <button onClick={handleEditClick} className={`flex items-center gap-2 px-5 py-2.5 rounded-lg font-bold transition-all border-2 shadow-ink-sm hover:shadow-ink hover:-translate-y-0.5 ${isEditing ? 'bg-white border-artisan-accent text-artisan-accent' : 'bg-artisan-ink border-artisan-ink text-white'}`}>
                                {isEditing ? <Icons.X className="w-5 h-5"/> : <Icons.Edit className="w-5 h-5"/>}
                                <span className="hidden md:inline">{isEditing ? 'é—œé–‰' : 'ç·¨è¼¯'}</span>
                            </button>
                        </div>
                    </div>

                    <div className="flex flex-1 overflow-hidden relative z-10">
                        {/* Editor */}
                        <div className={`absolute top-0 left-0 h-full bg-artisan-cream/95 backdrop-blur-xl shadow-ink z-40 transition-transform duration-300 flex flex-col w-full md:w-1/3 max-w-lg border-r-4 border-artisan-ink/10 ${isEditing ? 'translate-x-0' : '-translate-x-full'}`}>
                            <div className="p-5 border-b-4 border-artisan-ink/10 bg-artisan-bg flex justify-between items-center">
                                <h2 className="font-bold flex items-center gap-2 text-artisan-ink text-xl"><Icons.Edit className="w-6 h-6 text-artisan-accent" /> è³‡æ–™ç¶­è­·ä¸­å¿ƒ</h2>
                                <button onClick={() => setIsEditing(false)} className="p-2 hover:bg-artisan-ink/10 rounded text-artisan-gray hover:text-artisan-ink"><Icons.X className="w-6 h-6"/></button>
                            </div>
                            <div className="flex-1 p-6 overflow-auto flex flex-col gap-4">
                                <div className="bg-artisan-yellow/50 p-4 rounded border-2 border-artisan-gold text-sm text-artisan-ink font-medium leading-relaxed shadow-sm">
                                    ğŸ‘‰ ç³»çµ±æº–å‚™å°±ç·’ã€‚<br/>ğŸ‘‰ è«‹è²¼ä¸Š Excel è³‡æ–™ (Tabåˆ†éš”)ã€‚<br/>ğŸ‘‰ æ™ºæ…§é˜²å‘†è§£æå·²å•Ÿç”¨ã€‚
                                </div>
                                <textarea className="flex-1 w-full p-4 border-2 border-artisan-ink/20 rounded-lg bg-white text-artisan-ink font-mono text-sm leading-relaxed focus:border-artisan-ink focus:shadow-ink-sm outline-none resize-none whitespace-pre shadow-inner" value={csvData} onChange={(e) => setCsvData(e.target.value)} spellCheck="false" />
                            </div>
                            <div className="p-6 border-t-4 border-artisan-ink/10 bg-artisan-bg">
                                <button onClick={() => setIsEditing(false)} className="w-full bg-artisan-gold text-white py-4 rounded-lg font-bold hover:bg-artisan-ink shadow-ink hover:shadow-ink-hover flex justify-center items-center gap-2 transition-all hover:-translate-y-1"><Icons.Save className="w-5 h-5"/> ç¢ºèªæ›´æ–°</button>
                            </div>
                        </div>

                        {/* Content */}
                        <div className="flex-1 overflow-auto relative bg-transparent" ref={containerRef}>
                            {viewMode === 'list' ? (
                                <div className="max-w-3xl mx-auto p-4 md:p-10 min-h-full">
                                    <div className="bg-white/80 backdrop-blur-sm rounded-xl border-2 border-artisan-ink/10 p-6 shadow-xl">
                                        <div className="pb-4 border-b-2 border-artisan-ink/10 text-sm font-bold text-artisan-gray mb-4 flex justify-between tracking-widest uppercase"><span>Personnel List</span><span>Online</span></div>
                                        {treeData ? <ListView node={treeData} searchTerm={searchTerm} /> : <div className="p-12 text-center text-artisan-gray font-bold animate-pulse">ç„¡è³‡æ–™ä¿¡è™Ÿ...</div>}
                                    </div>
                                </div>
                            ) : (
                                <div 
                                    className="min-w-full min-h-full relative cursor-move"
                                    onMouseDown={(e) => {
                                        const ele = containerRef.current;
                                        if (!ele) return;
                                        ele.style.cursor = 'grabbing';
                                        ele.style.userSelect = 'none';
                                        const startX = e.pageX - ele.offsetLeft;
                                        const startY = e.pageY - ele.offsetTop;
                                        const scrollLeft = ele.scrollLeft;
                                        const scrollTop = ele.scrollTop;
                                        const mouseMoveHandler = (e) => {
                                            const x = e.pageX - ele.offsetLeft;
                                            const y = e.pageY - ele.offsetTop;
                                            ele.scrollLeft = scrollLeft - (x - startX) * 1.5;
                                            ele.scrollTop = scrollTop - (y - startY) * 1.5;
                                        };
                                        const mouseUpHandler = () => {
                                            ele.style.cursor = 'move';
                                            ele.style.removeProperty('user-select');
                                            document.removeEventListener('mousemove', mouseMoveHandler);
                                            document.removeEventListener('mouseup', mouseUpHandler);
                                        };
                                        document.addEventListener('mousemove', mouseMoveHandler);
                                        document.addEventListener('mouseup', mouseUpHandler);
                                    }}
                                >
                                    <div className="min-w-max min-h-max p-10 md:p-20 flex justify-center origin-top transition-transform duration-300 ease-out" style={{ transform: `scale(${scale})` }}>
                                        {treeData ? <OrgNode node={treeData} level={0} searchTerm={searchTerm} /> : <div className="text-center text-artisan-gold mt-20 font-bold text-xl animate-pulse">æ­£åœ¨ç¹ªè£½æº«æš–å®¶åœ’...</div>}
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
